function [dzdt, u__t,tau__1,tau__2,tau__3, h1,h2,h3,h4,ch,ch_dt,tmp] = UAV_quasi(t,z,m,g,J,J_inv,K1,K2,K3,K4,r1,r2,vd)


p = [z(1);z(2);z(3)];
v = [z(4);z(5);z(6)];


% rotational states
r11 = z(7);  r12 = z(8); r13 = z(9);
r21 = z(10); r22 = z(11);r23 = z(12);
r31 = z(13); r32 = z(14);r33 = z(15);

OM = [z(16);z(17);z(18)];

%SVD trick
[UU,S,VV] = svd([r11, r12, r13; ...
    r21, r22, r23; ...
    r31, r32, r33]);
R  = UU*VV.';
r11=R(1,1);
r12=R(1,2);
r13= R(1,3);

r21= R(2,1);
r22= R(2,2);
r23= R(2,3);

r31= R(3,1);
r32= R(3,2);
r33= R(3,3);

% w/o svd
% R = [r11, r12, r13;...
%      r21, r22, r23;...
%      r31, r32, r33];

%% Computing 2-1-3 Euler angles needed for the controller
eta = rotm2eul(R,"YXZ");

%% Relableing for Maple
p__1=p(1); p__2=p(2); p__3=p(3);
v__1=v(1); v__2=v(2); v__3=v(3);

theta = eta(1); phi = eta(2); psi = eta(3);


Omega__1 = OM(1); Omega__2 = OM(2); Omega__3 = OM(3);

J__1 = J(1,1); J__2 = J(2,2); J__3 = J(3,3);
k__21 = K2(1); k__22 = K2(2);
%% Normal basis vectors
e3 = [0;0;1];

%% Some kinematics relations
W =[sin(psi) * sec(phi) cos(psi) * sec(phi) 0;...
    cos(psi) -sin(psi) 0;...
    sin(psi) * tan(phi) cos(psi) * tan(phi) 1;];

eta_dt = W * OM;


% W_dt = [(tan(phi) * cos(psi) ^ 2 * Omega__2 + (sin(psi) * (Omega__2 * sec(phi) + Omega__1) * tan(phi) + Omega__3) * cos(psi) + sec(phi) * sin(psi) ^ 2 * tan(phi) * Omega__1) * sec(phi) (-sin(psi) ^ 2 * tan(phi) * Omega__1 + (cos(psi) * (Omega__1 * sec(phi) - Omega__2) * tan(phi) - Omega__3) * sin(psi) + cos(psi) ^ 2 * Omega__2 * sec(phi) * tan(phi)) * sec(phi) 0; -(Omega__3 + tan(phi) * (Omega__1 * sin(psi) + Omega__2 * cos(psi))) * sin(psi) -cos(psi) * (Omega__3 + tan(phi) * (Omega__1 * sin(psi) + Omega__2 * cos(psi))) 0; cos(psi) ^ 2 * tan(phi) ^ 2 * Omega__2 + ((Omega__2 * sec(phi) ^ 3 + Omega__1 * tan(phi) ^ 2) * sin(psi) + tan(phi) * Omega__3) * cos(psi) + sin(psi) ^ 2 * Omega__1 * sec(phi) ^ 3 -sin(psi) ^ 2 * tan(phi) ^ 2 * Omega__1 + ((Omega__1 * sec(phi) ^ 3 - Omega__2 * tan(phi) ^ 2) * cos(psi) - tan(phi) * Omega__3) * sin(psi) + cos(psi) ^ 2 * Omega__2 * sec(phi) ^ 3 0;];
W_dt = [sec(phi) * (tan(phi) * cos(psi) ^ 2 * Omega__2 + (sin(psi) * (Omega__2 * sec(phi) + Omega__1) * tan(phi) + Omega__3) * cos(psi) + sec(phi) * sin(psi) ^ 2 * tan(phi) * Omega__1) sec(phi) * (-sin(psi) ^ 2 * tan(phi) * Omega__1 + (cos(psi) * (Omega__1 * sec(phi) - Omega__2) * tan(phi) - Omega__3) * sin(psi) + cos(psi) ^ 2 * Omega__2 * sec(phi) * tan(phi)) 0; -sin(psi) * (Omega__3 + tan(phi) * (Omega__1 * sin(psi) + Omega__2 * cos(psi))) -cos(psi) * (Omega__3 + tan(phi) * (Omega__1 * sin(psi) + Omega__2 * cos(psi))) 0; tan(phi) ^ 2 * cos(psi) ^ 2 * Omega__2 + ((Omega__2 * sec(phi) ^ 3 + tan(phi) ^ 2 * Omega__1) * sin(psi) + Omega__3 * tan(phi)) * cos(psi) + sin(psi) ^ 2 * Omega__1 * sec(phi) ^ 3 -sin(psi) ^ 2 * tan(phi) ^ 2 * Omega__1 + ((Omega__1 * sec(phi) ^ 3 - Omega__2 * tan(phi) ^ 2) * cos(psi) - Omega__3 * tan(phi)) * sin(psi) + cos(psi) ^ 2 * Omega__2 * sec(phi) ^ 3 0;];


%% The output h

h1 = p__1 ^ 2 + p__2 ^ 2 - r1 ^ 2;
h2 = p__3 - r2;
h3 = -(vd * sqrt(p__1 ^ 2 + p__2 ^ 2) + p__1 * v__2 - p__2 * v__1) * (p__1 ^ 2 + p__2 ^ 2) ^ (-0.1e1 / 0.2e1);
h4 =  psi - atan2(p__2 , p__1);


%% 1st time derivative of h
h1__dt =  2 * p__1 * v__1 + 2 * p__2 * v__2;
h2__dt = v__3;
h3__dt = -sec(theta) * (-cos(theta) * (p__1 * v__1 + p__2 * v__2) * (p__1 * v__2 - p__2 * v__1) + (p__1 * tan(phi) + p__2 * sin(theta)) * (g + k__21 * (p__3 - r2) + k__22 * v__3) * (p__1 ^ 2 + p__2 ^ 2)) * (p__1 ^ 2 + p__2 ^ 2) ^ (-0.3e1 / 0.2e1);
h4__dt = v__1 * p__2 / (p__1 ^ 2 + p__2 ^ 2) - v__2 * p__1 / (p__1 ^ 2 + p__2 ^ 2) + sin(psi) * tan(phi) * Omega__1 + cos(psi) * tan(phi) * Omega__2 + Omega__3;


%% 2nd time derivative of h1 and h3



h1__ddt = (2 * v__1 ^ 2) + (2 * v__2 ^ 2) - 0.2e1 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * (p__1 * tan(theta) - p__2 * tan(phi) * sec(theta));
%h2__ddt = (r2 - p__3) * k__21 - k__22 * v__3;
h3__ddt = -sec(theta) ^ 2 * (0.2e1 * (p__1 * v__2 - p__2 * v__1) * (p__2 ^ 2 * (-v__1 ^ 2 / 0.2e1 + v__2 ^ 2) + 0.3e1 * p__1 * p__2 * v__1 * v__2 + (v__1 ^ 2 - v__2 ^ 2 / 0.2e1) * p__1 ^ 2) * cos(theta) ^ 2 + ((-v__3 * p__2 * (p__1 ^ 2 + p__2 ^ 2) * k__22 ^ 2 + ((0.2e1 * p__1 ^ 2 * v__2 - 0.3e1 * p__1 * p__2 * v__1 - p__2 ^ 2 * v__2) * v__3 + k__21 * p__2 * (p__1 ^ 2 + p__2 ^ 2) * (r2 - p__3)) * k__22 + k__21 * p__2 * (p__1 ^ 2 + p__2 ^ 2) * v__3 + 0.2e1 * (p__1 ^ 2 * v__2 - 0.3e1 / 0.2e1 * p__1 * p__2 * v__1 - p__2 ^ 2 * v__2 / 0.2e1) * (k__21 * (p__3 - r2) + g)) * sin(theta) + (g + k__21 * (p__3 - r2) + k__22 * v__3) * sec(phi) ^ 2 * p__1 * Omega__1 * (p__1 ^ 2 + p__2 ^ 2) * cos(psi) - (g + k__21 * (p__3 - r2) + k__22 * v__3) * sin(psi) * p__1 * Omega__2 * (p__1 ^ 2 + p__2 ^ 2) * sec(phi) ^ 2 - tan(phi) * (v__3 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * k__22 ^ 2 + ((p__1 ^ 2 * v__1 + 0.3e1 * p__1 * p__2 * v__2 - 0.2e1 * p__2 ^ 2 * v__1) * v__3 - k__21 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * (r2 - p__3)) * k__22 - k__21 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * v__3 + (p__1 ^ 2 * v__1 + 0.3e1 * p__1 * p__2 * v__2 - 0.2e1 * p__2 ^ 2 * v__1) * (k__21 * (p__3 - r2) + g))) * (p__1 ^ 2 + p__2 ^ 2) * cos(theta) + (Omega__1 * sin(psi) + Omega__2 * cos(psi)) * (g + k__21 * (p__3 - r2) + k__22 * v__3) * sec(phi) * (tan(phi) * sin(theta) * p__1 + p__2) * (p__1 ^ 2 + p__2 ^ 2) ^ 2) * (p__1 ^ 2 + p__2 ^ 2) ^ (-0.5e1 / 0.2e1);



%% 3rd time derivative of h1
h1__dddt = (0.2e1 * (Omega__1 * sin(psi) + Omega__2 * cos(psi)) * p__2 * tan(theta) * (g + k__21 * (p__3 - r2) + k__22 * v__3) * tan(phi) * sec(phi) + 0.2e1 * (cos(psi) * Omega__1 - sin(psi) * Omega__2) * p__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * tan(phi) ^ 2 + ((((0.2e1 * r2 - 0.2e1 * p__3) * k__22 + 0.2e1 * v__3) * p__2 - 0.6e1 * v__2 * ( r2 - p__3)) * k__21 - 0.2e1 * k__22 ^ 2 * p__2 * v__3 + 0.6e1 * v__2 * (k__22 * v__3 + g)) * tan(phi) + 0.2e1 * (Omega__1 * cos(psi) * p__2 - Omega__2 * sin(psi) * p__2 + sin(theta) * (k__22 * p__1 - (2 * v__1))) * (g + k__21 * (p__3 - r2) + k__22 * v__3)) * sec(theta) - 0.2e1 * (0.1e1 + tan(theta) ^ 2) * (Omega__1 * sin(psi) + Omega__2 * cos(psi)) * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 * sec(phi) - 0.2e1 * tan(theta) * ((p__1 * v__3 - v__1 * ( r2 - p__3)) * k__21 + g * k__22 * p__1 + v__1 * (k__22 * v__3 + g));




%% Aux inputs for y3 and y4
nu__1 = -K1*[h1;h1__dt;h1__ddt; h1__dddt];

nu__2 = -K2*[h2;h2__dt;];

nu__3 = -K3*[h3;h3__dt;h3__ddt];

nu__4 = -K4*[h4;h4__dt];

%% Checking stuff...
ch = h1__ddt;
ch_dt = h1__dddt;

%% QSF

%% thrust
u__t = m*(g - nu__2)/(cos(theta)*cos(phi))*1;


%% tau: old way

% tau__1 = (-((-sin(phi) * sin(theta) * p__2 + cos(phi) * p__1) * cos(psi) + sin(psi) * cos(theta) * p__2) * cos(phi) * nu__3 * cos(theta) * (p__1 ^ 2 + p__2 ^ 2) ^ (0.7e1 / 0.2e1) * J__1 - 0.2e1 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * J__1 * ((p__1 ^ 2 + p__2 ^ 2) ^ 2 * ((0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * cos(theta) - 0.9e1 * sec(theta) * (v__1 * p__1 ^ 2 * p__2 + v__1 * p__2 ^ 3 / 0.9e1 + v__2 * p__1 ^ 3 / 0.9e1 + v__2 * p__1 * p__2 ^ 2)) * Omega__2 * cos(phi) / 0.2e1 - Omega__2 * sec(phi) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * cos(theta) + Omega__1 * tan(phi) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * sin(theta) - 0.5e1 / 0.2e1 * tan(theta) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * Omega__2 * (v__1 * p__1 ^ 3 - 0.3e1 / 0.5e1 * v__1 * p__1 * p__2 ^ 2 + 0.3e1 / 0.5e1 * v__2 * p__1 ^ 2 * p__2 - v__2 * p__2 ^ 3) * sin(phi) + Omega__2 * sec(theta) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * sec(phi) / 0.2e1 - 0.5e1 / 0.2e1 * (v__1 * p__1 ^ 7 + 0.7e1 / 0.5e1 * v__1 * p__1 ^ 5 * p__2 ^ 2 - v__1 * p__1 ^ 3 * p__2 ^ 4 / 0.5e1 - 0.3e1 / 0.5e1 * v__1 * p__1 * p__2 ^ 6 + v__2 * p__1 ^ 4 * p__2 ^ 3 / 0.5e1 - 0.7e1 / 0.5e1 * v__2 * p__1 ^ 2 * p__2 ^ 5 - v__2 * p__2 ^ 7) * Omega__1) * cos(psi) ^ 2 + 0.18e2 * (((nu__1 * p__2 ^ 7 / 0.36e2 + ((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + v__3 ^ 2 * k__22 ^ 2 + 0.2e1 * v__3 * k__22 * g + g ^ 2 + nu__1 / 0.6e1) * p__1 ^ 2 * p__2 ^ 5 / 0.2e1 + v__2 * p__1 * v__1 * (v__1 ^ 2 - 0.2e1 / 0.3e1 * v__2 ^ 2) * p__2 ^ 4 / 0.2e1 + p__1 ^ 2 * (((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + 0.2e1 * v__3 * k__22 * g + g ^ 2 + nu__1 / 0.12e2 + v__3 ^ 2 * k__22 ^ 2) * p__1 ^ 2 + v__1 ^ 4 / 0.2e1 + v__2 ^ 4 / 0.3e1 - 0.5e1 / 0.2e1 * v__1 ^ 2 * v__2 ^ 2) * p__2 ^ 3 + 0.5e1 / 0.2e1 * (-v__2 * v__1 ^ 3 + v__2 ^ 3 * v__1) * p__1 ^ 3 * p__2 ^ 2 - p__1 ^ 4 * (v__1 ^ 4 - 0.15e2 / 0.2e1 * v__1 ^ 2 * v__2 ^ 2 + 0.3e1 / 0.2e1 * v__2 ^ 4 - nu__1 * p__1 ^ 2 / 0.12e2) * p__2 / 0.3e1 + v__2 * p__1 ^ 5 * v__1 * (v__1 ^ 2 - 0.3e1 / 0.2e1 * v__2 ^ 2) / 0.3e1) * cos(theta) + (-(g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * p__1 ^ 6 * p__2 * tan(theta) / 0.2e1 - (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__2 ^ 7 / 0.18e2 - v__2 * p__1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__2 ^ 6 / 0.2e1 + 0.7e1 / 0.6e1 * p__1 * (-0.11e2 / 0.21e2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.5e1 / 0.7e1 * v__2 ^ 2)) * p__2 ^ 5 - 0.5e1 / 0.2e1 * v__2 * p__1 ^ 2 * (0.19e2 / 0.45e2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 4 + p__1 ^ 3 * (-0.19e2 / 0.6e1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 + v__2 ^ 2)) * p__2 ^ 3 / 0.3e1 - 0.5e1 / 0.2e1 * (0.11e2 / 0.45e2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * v__2 * p__1 ^ 4 * p__2 ^ 2 - 0.5e1 / 0.6e1 * (0.3e1 / 0.5e1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (v__1 ^ 2 - 0.7e1 / 0.5e1 * v__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3)) * p__1 ^ 5 * p__2 + v__2 * ((((r2 - p__3) * k__22 + v__3) * k__21 - k__22 ^ 2 * v__3) * p__1 / 0.9e1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__1 ^ 6 / 0.2e1) * sin(theta) - 0.5e1 / 0.6e1 * (g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * sec(theta) * (p__1 ^ 4 + p__1 ^ 2 * p__2 ^ 2 / 0.5e1 - p__2 ^ 4 / 0.5e1) * p__2 ^ 3) * cos(phi) ^ 2 + (-(g + k__21 * (p__3 - r2) + k__22 * v__3) * Omega__1 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * ((0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * cos(theta) - 0.9e1 * sec(theta) * (v__1 * p__1 ^ 2 * p__2 + v__1 * p__2 ^ 3 / 0.9e1 + v__2 * p__1 ^ 3 / 0.9e1 + v__2 * p__1 * p__2 ^ 2)) * sin(psi) / 0.6e1 + (((g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * p__1 ^ 5 * p__2 ^ 2 * tan(theta) + ((p__3 - r2) * k__21 ^ 2 - k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 - v__3 * k__22 ^ 3) * p__2 ^ 8 / 0.6e1 - v__2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__2 ^ 7 / 0.6e1 + 0.2e1 / 0.3e1 * p__1 ^ 2 * ((p__3 - r2) * k__21 ^ 2 - k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 - v__3 * k__22 ^ 3) * p__2 ^ 6 - 0.9e1 / 0.2e1 * v__2 * p__1 * ((((r2 - p__3) * k__22 + v__3) * k__21 - k__22 ^ 2 * v__3) * p__1 / 0.27e2 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 5 - p__1 ^ 2 * (((r2 - p__3) * k__21 ^ 2 + k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 + v__3 * k__22 ^ 3) * p__1 ^ 2 - 0.2e1 / 0.3e1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.2e1 * v__2 ^ 2)) * p__2 ^ 4 - 0.3e1 * v__2 * p__1 ^ 3 * (0.5e1 / 0.18e2 * (((r2 - p__3) * k__22 + v__3) * k__21 - k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 3 - 0.2e1 * p__1 ^ 4 * (((r2 - p__3) * k__21 ^ 2 + k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 + v__3 * k__22 ^ 3) * p__1 ^ 2 / 0.3e1 - 0.2e1 / 0.3e1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (v__1 ^ 2 - 0.5e1 / 0.4e1 * v__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3)) * p__2 ^ 2 + 0.3e1 / 0.2e1 * v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 5 * v__1 * p__2 + 0.2e1 / 0.3e1 * (((p__3 - r2) * k__21 ^ 2 - k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 - v__3 * k__22 ^ 3) * p__1 / 0.4e1 + (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1) * p__1 ^ 7) * cos(theta) ^ 2 + (nu__1 * p__1 * p__2 ^ 6 / 0.6e1 + (-0.3e1 * v__2 * v__1 ^ 3 + 0.2e1 * v__2 ^ 3 * v__1) * p__2 ^ 5 + p__1 * (((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + nu__1 / 0.2e1 + g ^ 2 + 0.2e1 * v__3 * k__22 * g + v__3 ^ 2 * k__22 ^ 2) * p__1 ^ 2 - 0.3e1 * v__1 ^ 4 + 0.15e2 * v__1 ^ 2 * v__2 ^ 2 - 0.2e1 * v__2 ^ 4) * p__2 ^ 4 + 0.15e2 * (v__2 * v__1 ^ 3 - v__2 ^ 3 * v__1) * p__1 ^ 2 * p__2 ^ 3 + 0.2e1 * p__1 ^ 3 * (v__1 ^ 4 - 0.15e2 / 0.2e1 * v__1 ^ 2 * v__2 ^ 2 + 0.3e1 / 0.2e1 * v__2 ^ 4 + nu__1 * p__1 ^ 2 / 0.4e1) * p__2 ^ 2 + (-0.2e1 * v__2 * v__1 ^ 3 + 0.3e1 * v__2 ^ 3 * v__1) * p__1 ^ 4 * p__2 + nu__1 * p__1 ^ 7 / 0.6e1) * sin(theta) * cos(theta) / 0.2e1 + (-(g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * p__1 ^ 7 * tan(theta) / 0.2e1 - ((v__1 ^ 2 - v__2 ^ 2 / 0.2e1) * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__2 ^ 5 + v__2 * p__1 ^ 6 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) / 0.2e1) * p__2) * sin(theta) ^ 2 + (g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * p__1 * p__2 ^ 2 * (p__1 ^ 4 + 0.3e1 * p__2 ^ 4) * tan(theta) / 0.2e1 + 0.5e1 / 0.6e1 * v__2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__2 ^ 7 + (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 * p__2 ^ 6 / 0.2e1 + 0.6e1 * v__2 * (0.7e1 / 0.36e2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__1 * p__2 ^ 5 + 0.7e1 / 0.2e1 * p__1 ^ 2 * ((((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 / 0.21e2 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.8e1 / 0.7e1 * v__2 ^ 2)) * p__2 ^ 4 - v__2 * p__1 ^ 4 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__2 ^ 3 / 0.6e1 + 0.4e1 * (-0.7e1 / 0.24e2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.7e1 / 0.8e1 * v__2 ^ 2)) * p__1 ^ 4 * p__2 ^ 2 - 0.6e1 * v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 5 * v__1 * p__2 - p__1 ^ 6 * (0.5e1 / 0.3e1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.2e1 * v__2 ^ 2)) / 0.2e1) * sin(phi)) * cos(phi) / 0.3e1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (sec(phi) * Omega__1 * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * cos(theta) + Omega__2 * tan(phi) * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * sin(theta) + 0.5e1 / 0.2e1 * tan(theta) * Omega__1 * (v__1 * p__1 ^ 3 - 0.3e1 / 0.5e1 * v__1 * p__1 * p__2 ^ 2 + 0.3e1 / 0.5e1 * v__2 * p__1 ^ 2 * p__2 - v__2 * p__2 ^ 3) * sin(phi) - Omega__1 * sec(theta) * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * sec(phi) / 0.2e1 - 0.5e1 / 0.2e1 * Omega__2 * (v__1 * p__1 ^ 3 - 0.3e1 / 0.5e1 * v__1 * p__1 * p__2 ^ 2 + 0.3e1 / 0.5e1 * v__2 * p__1 ^ 2 * p__2 - v__2 * p__2 ^ 3)) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * sin(psi) / 0.9e1 - (g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * (p__1 ^ 4 - p__1 ^ 2 * p__2 ^ 2 - p__2 ^ 4) * p__2 ^ 3 * cos(theta) / 0.6e1 + (-v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1 * p__2 ^ 6 * sin(phi) ^ 2 / 0.2e1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * p__1 ^ 6 * p__2 * tan(theta) / 0.6e1 - (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__2 ^ 7 / 0.6e1 + 0.4e1 / 0.9e1 * v__2 * p__1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__2 ^ 6 - 0.5e1 / 0.6e1 * p__1 * ((((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 / 0.3e1 + (v__1 ^ 2 - 0.4e1 / 0.5e1 * v__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3)) * p__2 ^ 5 + v__2 * p__1 ^ 2 * (0.10e2 / 0.9e1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 4 - 0.2e1 / 0.3e1 * p__1 ^ 3 * ((((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 / 0.12e2 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - v__2 ^ 2 / 0.2e1)) * p__2 ^ 3 + 0.3e1 / 0.2e1 * (0.16e2 / 0.27e2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * v__2 * p__1 ^ 4 * p__2 ^ 2 + ((((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 / 0.3e1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.2e1 * v__2 ^ 2)) * p__1 ^ 5 * p__2 / 0.6e1 + 0.2e1 / 0.9e1 * v__2 * p__1 ^ 7 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3)) * sin(theta) - 0.5e1 / 0.6e1 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * (tan(theta) * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 3 * tan(phi) * p__2 ^ 4 * sin(phi) ^ 2 + 0.2e1 / 0.15e2 * Omega__1 * Omega__2 * tan(theta) * (p__1 ^ 2 + p__2 ^ 2) ^ 4 * sec(phi) + (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 * tan(phi) * (p__1 ^ 6 + 0.4e1 * p__1 ^ 4 * p__2 ^ 2 + 0.2e1 * p__2 ^ 6) * tan(theta) / 0.5e1 + 0.2e1 / 0.15e2 * Omega__1 ^ 2 * (p__1 ^ 2 + p__2 ^ 2) ^ 4 * tan(phi) + 0.3e1 / 0.5e1 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * sec(theta) * (p__1 ^ 2 + 0.2e1 / 0.3e1 * p__2 ^ 2) * p__2 ^ 5)) * J__1 * cos(psi) - 0.3e1 * sin(psi) * ((nu__1 * p__1 * p__2 ^ 6 / 0.6e1 + (-0.3e1 * v__2 * v__1 ^ 3 + 0.2e1 * v__2 ^ 3 * v__1) * p__2 ^ 5 + p__1 * (((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + nu__1 / 0.2e1 + g ^ 2 + 0.2e1 * v__3 * k__22 * g + v__3 ^ 2 * k__22 ^ 2) * p__1 ^ 2 - 0.3e1 * v__1 ^ 4 + 0.15e2 * v__1 ^ 2 * v__2 ^ 2 - 0.2e1 * v__2 ^ 4) * p__2 ^ 4 + 0.15e2 * (v__2 * v__1 ^ 3 - v__2 ^ 3 * v__1) * p__1 ^ 2 * p__2 ^ 3 + 0.2e1 * p__1 ^ 3 * (((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + v__3 ^ 2 * k__22 ^ 2 + 0.2e1 * v__3 * k__22 * g + g ^ 2 + nu__1 / 0.4e1) * p__1 ^ 2 + v__1 ^ 4 - 0.15e2 / 0.2e1 * v__1 ^ 2 * v__2 ^ 2 + 0.3e1 / 0.2e1 * v__2 ^ 4) * p__2 ^ 2 + (-0.2e1 * v__2 * v__1 ^ 3 + 0.3e1 * v__2 ^ 3 * v__1) * p__1 ^ 4 * p__2 + ((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + v__3 ^ 2 * k__22 ^ 2 + 0.2e1 * v__3 * k__22 * g + g ^ 2 + nu__1 / 0.6e1) * p__1 ^ 7) * cos(theta) ^ 2 + 0.4e1 * (((r2 - p__3) * k__21 ^ 2 + k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 + v__3 * k__22 ^ 3) * p__2 ^ 6 / 0.12e2 + v__2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__2 ^ 5 / 0.12e2 + (((r2 - p__3) * k__21 ^ 2 + k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 + v__3 * k__22 ^ 3) * p__1 ^ 2 / 0.2e1 - (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - v__2 ^ 2 / 0.2e1)) * p__2 ^ 4 / 0.2e1 + 0.9e1 / 0.4e1 * v__2 * p__1 * (0.2e1 / 0.27e2 * (((r2 - p__3) * k__22 + v__3) * k__21 - k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 3 + p__1 ^ 2 * (((r2 - p__3) * k__21 ^ 2 + k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 + v__3 * k__22 ^ 3) * p__1 ^ 2 / 0.4e1 - (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 / 0.3e1 + (v__1 ^ 2 - 0.5e1 / 0.4e1 * v__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3)) * p__2 ^ 2 - 0.3e1 / 0.4e1 * v__2 * p__1 ^ 3 * ((((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 / 0.3e1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 - (((p__3 - r2) * k__21 ^ 2 - k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 - v__3 * k__22 ^ 3) * p__1 / 0.4e1 + (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1) * p__1 ^ 5 / 0.3e1) * (p__1 ^ 2 + p__2 ^ 2) * sin(theta) * cos(theta) + 0.2e1 * (p__1 ^ 2 + 0.2e1 * p__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * p__1 ^ 3 * p__2 ^ 2) * J__1 * cos(phi) - 0.3e1 * v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 6 * Omega__1 * J__1 * p__2 * sin(psi) ^ 2 + 0.3e1 * (-(-(((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__2 ^ 5 - 0.3e1 * v__2 * (0.8e1 / 0.9e1 * (((r2 - p__3) * k__22 + v__3) * k__21 - k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 4 - 0.5e1 * p__1 * (0.2e1 / 0.15e2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (v__1 ^ 2 - 0.4e1 / 0.5e1 * v__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3)) * p__2 ^ 3 + 0.9e1 * v__2 * p__1 ^ 2 * (0.4e1 / 0.9e1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 2 + ((((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 / 0.3e1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.2e1 * v__2 ^ 2)) * p__1 ^ 3 * p__2 + 0.4e1 / 0.3e1 * v__2 * p__1 ^ 5 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3)) * sin(phi) * (p__1 ^ 2 + p__2 ^ 2) * cos(theta) + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (-(g + k__21 * (p__3 - r2) + k__22 * v__3) * sin(phi) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (p__2 + p__1) * (p__1 - p__2) * p__2 * sin(theta) + 0.2e1 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 * tan(phi) * p__2 ^ 6 * sin(phi) + (-0.2e1 / 0.3e1 * Omega__1 ^ 2 * (p__1 ^ 2 + p__2 ^ 2) ^ 4 * tan(theta) + (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 3 * (p__1 ^ 4 + 0.4e1 * p__1 ^ 2 * p__2 ^ 2 + 0.5e1 * p__2 ^ 4)) * sec(phi) + 0.2e1 / 0.3e1 * Omega__1 * Omega__2 * tan(phi) * (p__1 ^ 2 + p__2 ^ 2) ^ 4)) * J__1 * sin(psi) - (g + k__21 * (p__3 - r2) + k__22 * v__3) * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * J__1 * Omega__2 * sec(phi) * cos(theta) + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * Omega__1 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * tan(phi) * J__1 * sin(theta) + (((0.2e1 * Omega__1 * (p__3 - r2) * k__22 - 0.2e1 * v__3 * Omega__1 + Omega__2 * Omega__3 * (p__3 - r2)) * k__21 + 0.2e1 * v__3 * k__22 ^ 2 * Omega__1 + Omega__3 * Omega__2 * v__3 * k__22 + Omega__3 * Omega__2 * g) * p__2 ^ 8 + v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * Omega__1 * p__2 ^ 7 + 0.4e1 * p__1 ^ 2 * ((0.2e1 * Omega__1 * (p__3 - r2) * k__22 - 0.2e1 * v__3 * Omega__1 + Omega__2 * Omega__3 * (p__3 - r2)) * k__21 + 0.2e1 * v__3 * k__22 ^ 2 * Omega__1 + Omega__3 * Omega__2 * v__3 * k__22 + Omega__3 * Omega__2 * g) * p__2 ^ 6 - v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 2 * Omega__1 * p__2 ^ 5 - 0.4e1 * p__1 ^ 3 * (0.3e1 * ((-Omega__1 * (p__3 - r2) * k__22 + v__3 * Omega__1 - Omega__2 * Omega__3 * (p__3 - r2) / 0.2e1) * k__21 - v__3 * k__22 ^ 2 * Omega__1 - Omega__3 * Omega__2 * v__3 * k__22 / 0.2e1 - Omega__3 * Omega__2 * g / 0.2e1) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * Omega__1 * v__1) * p__2 ^ 4 - 0.5e1 * v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 4 * Omega__1 * p__2 ^ 3 - 0.8e1 * p__1 ^ 5 * (((-Omega__1 * (p__3 - r2) * k__22 + v__3 * Omega__1 - Omega__2 * Omega__3 * (p__3 - r2) / 0.2e1) * k__21 - v__3 * k__22 ^ 2 * Omega__1 - Omega__3 * Omega__2 * v__3 * k__22 / 0.2e1 - Omega__3 * Omega__2 * g / 0.2e1) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * Omega__1 * v__1) * p__2 ^ 2 - 0.4e1 * p__1 ^ 7 * (((-Omega__1 * (p__3 - r2) * k__22 + v__3 * Omega__1 - Omega__2 * Omega__3 * (p__3 - r2) / 0.2e1) * k__21 - v__3 * k__22 ^ 2 * Omega__1 - Omega__3 * Omega__2 * v__3 * k__22 / 0.2e1 - Omega__3 * Omega__2 * g / 0.2e1) * p__1 / 0.2e1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * Omega__1 * v__1)) * J__1 - Omega__3 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * (J__2 - J__3) * (p__1 ^ 2 + p__2 ^ 2) ^ 4 * Omega__2) / (g + k__21 * (p__3 - r2) + k__22 * v__3) / (p__1 ^ 2 + p__2 ^ 2) ^ 4;
% tau__2 = (J__2 * cos(phi) * nu__3 * cos(theta) * (p__1 ^ 2 + p__2 ^ 2) ^ (0.7e1 / 0.2e1) * ((-sin(phi) * sin(theta) * p__2 + cos(phi) * p__1) * sin(psi) - cos(psi) * cos(theta) * p__2) - 0.9e1 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * J__2 * (Omega__1 * sec(theta) * (v__1 * p__1 ^ 2 * p__2 + v__1 * p__2 ^ 3 / 0.9e1 + v__2 * p__1 ^ 3 / 0.9e1 + v__2 * p__1 * p__2 ^ 2) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * cos(phi) + 0.5e1 / 0.9e1 * tan(theta) * Omega__1 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (v__1 * p__1 ^ 3 - 0.3e1 / 0.5e1 * v__1 * p__1 * p__2 ^ 2 + 0.3e1 / 0.5e1 * v__2 * p__1 ^ 2 * p__2 - v__2 * p__2 ^ 3) * sin(phi) - Omega__1 * sec(theta) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * sec(phi) / 0.9e1 + v__1 * Omega__2 * p__1 * p__2 ^ 6 / 0.3e1) * sin(psi) ^ 2 - 0.3e1 * (-0.2e1 / 0.3e1 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * (((0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * cos(theta) - 0.9e1 * sec(theta) * (v__1 * p__1 ^ 2 * p__2 + v__1 * p__2 ^ 3 / 0.9e1 + v__2 * p__1 ^ 3 / 0.9e1 + v__2 * p__1 * p__2 ^ 2)) * Omega__2 * cos(phi) / 0.2e1 - Omega__2 * sec(phi) * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * cos(theta) + Omega__1 * tan(phi) * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * sin(theta) - 0.5e1 / 0.2e1 * tan(theta) * Omega__2 * (v__1 * p__1 ^ 3 - 0.3e1 / 0.5e1 * v__1 * p__1 * p__2 ^ 2 + 0.3e1 / 0.5e1 * v__2 * p__1 ^ 2 * p__2 - v__2 * p__2 ^ 3) * sin(phi) + Omega__2 * sec(theta) * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * sec(phi) / 0.2e1 - 0.5e1 / 0.2e1 * Omega__1 * (v__1 * p__1 ^ 3 - 0.3e1 / 0.5e1 * v__1 * p__1 * p__2 ^ 2 + 0.3e1 / 0.5e1 * v__2 * p__1 ^ 2 * p__2 - v__2 * p__2 ^ 3)) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * cos(psi) + ((nu__1 * p__2 ^ 7 / 0.6e1 + 0.3e1 * ((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + v__3 ^ 2 * k__22 ^ 2 + 0.2e1 * v__3 * k__22 * g + g ^ 2 + nu__1 / 0.6e1) * p__1 ^ 2 * p__2 ^ 5 + (0.3e1 * v__2 * v__1 ^ 3 - 0.2e1 * v__2 ^ 3 * v__1) * p__1 * p__2 ^ 4 + 0.6e1 * p__1 ^ 2 * (((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + 0.2e1 * v__3 * k__22 * g + g ^ 2 + nu__1 / 0.12e2 + v__3 ^ 2 * k__22 ^ 2) * p__1 ^ 2 + v__1 ^ 4 / 0.2e1 + v__2 ^ 4 / 0.3e1 - 0.5e1 / 0.2e1 * v__1 ^ 2 * v__2 ^ 2) * p__2 ^ 3 + 0.15e2 * (-v__2 * v__1 ^ 3 + v__2 ^ 3 * v__1) * p__1 ^ 3 * p__2 ^ 2 - 0.2e1 * p__1 ^ 4 * (v__1 ^ 4 - 0.15e2 / 0.2e1 * v__1 ^ 2 * v__2 ^ 2 + 0.3e1 / 0.2e1 * v__2 ^ 4 - nu__1 * p__1 ^ 2 / 0.12e2) * p__2 + (0.2e1 * v__2 * v__1 ^ 3 - 0.3e1 * v__2 ^ 3 * v__1) * p__1 ^ 5) * cos(theta) + (-0.3e1 * (g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * p__1 ^ 6 * p__2 * tan(theta) - (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__2 ^ 7 / 0.3e1 - 0.3e1 * v__2 * p__1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__2 ^ 6 + 0.7e1 * p__1 * (-0.11e2 / 0.21e2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.5e1 / 0.7e1 * v__2 ^ 2)) * p__2 ^ 5 - 0.15e2 * v__2 * p__1 ^ 2 * (0.19e2 / 0.45e2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 4 + 0.2e1 * p__1 ^ 3 * (-0.19e2 / 0.6e1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 + v__2 ^ 2)) * p__2 ^ 3 - 0.15e2 * (0.11e2 / 0.45e2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * v__2 * p__1 ^ 4 * p__2 ^ 2 - 0.5e1 * (0.3e1 / 0.5e1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (v__1 ^ 2 - 0.7e1 / 0.5e1 * v__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3)) * p__1 ^ 5 * p__2 + 0.3e1 * v__2 * ((((r2 - p__3) * k__22 + v__3) * k__21 - k__22 ^ 2 * v__3) * p__1 / 0.9e1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__1 ^ 6) * sin(theta) + (g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * (tan(theta) * p__1 * (p__1 ^ 4 + 0.3e1 * p__2 ^ 4) * tan(phi) - 0.5e1 * sec(theta) * (p__1 ^ 4 + p__1 ^ 2 * p__2 ^ 2 / 0.5e1 - p__2 ^ 4 / 0.5e1) * p__2) * p__2 ^ 2) * cos(phi) ^ 2 + 0.2e1 * sin(phi) * ((((p__3 - r2) * k__21 ^ 2 - k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 - v__3 * k__22 ^ 3) * p__2 ^ 8 / 0.6e1 - v__2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__2 ^ 7 / 0.6e1 + 0.2e1 / 0.3e1 * p__1 ^ 2 * ((p__3 - r2) * k__21 ^ 2 - k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 - v__3 * k__22 ^ 3) * p__2 ^ 6 - 0.9e1 / 0.2e1 * v__2 * p__1 * ((((r2 - p__3) * k__22 + v__3) * k__21 - k__22 ^ 2 * v__3) * p__1 / 0.27e2 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 5 - p__1 ^ 2 * (((r2 - p__3) * k__21 ^ 2 + k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 + v__3 * k__22 ^ 3) * p__1 ^ 2 - 0.2e1 / 0.3e1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.2e1 * v__2 ^ 2)) * p__2 ^ 4 - 0.3e1 * v__2 * p__1 ^ 3 * (0.5e1 / 0.18e2 * (((r2 - p__3) * k__22 + v__3) * k__21 - k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 3 - 0.2e1 * p__1 ^ 4 * (((r2 - p__3) * k__21 ^ 2 + k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 + v__3 * k__22 ^ 3) * p__1 ^ 2 / 0.3e1 - 0.2e1 / 0.3e1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (v__1 ^ 2 - 0.5e1 / 0.4e1 * v__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3)) * p__2 ^ 2 + 0.3e1 / 0.2e1 * v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 5 * v__1 * p__2 + 0.2e1 / 0.3e1 * (((p__3 - r2) * k__21 ^ 2 - k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 - v__3 * k__22 ^ 3) * p__1 / 0.4e1 + (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1) * p__1 ^ 7) * cos(theta) ^ 2 + (nu__1 * p__1 * p__2 ^ 6 / 0.12e2 + (-0.3e1 / 0.2e1 * v__2 * v__1 ^ 3 + v__2 ^ 3 * v__1) * p__2 ^ 5 + p__1 * (((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + nu__1 / 0.2e1 + g ^ 2 + 0.2e1 * v__3 * k__22 * g + v__3 ^ 2 * k__22 ^ 2) * p__1 ^ 2 - 0.3e1 * v__1 ^ 4 + 0.15e2 * v__1 ^ 2 * v__2 ^ 2 - 0.2e1 * v__2 ^ 4) * p__2 ^ 4 / 0.2e1 + 0.15e2 / 0.2e1 * (v__2 * v__1 ^ 3 - v__2 ^ 3 * v__1) * p__1 ^ 2 * p__2 ^ 3 + p__1 ^ 3 * (((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + v__3 ^ 2 * k__22 ^ 2 + 0.2e1 * v__3 * k__22 * g + g ^ 2 + nu__1 / 0.4e1) * p__1 ^ 2 + v__1 ^ 4 - 0.15e2 / 0.2e1 * v__1 ^ 2 * v__2 ^ 2 + 0.3e1 / 0.2e1 * v__2 ^ 4) * p__2 ^ 2 - v__2 * p__1 ^ 4 * v__1 * (v__1 ^ 2 - 0.3e1 / 0.2e1 * v__2 ^ 2) * p__2 + nu__1 * p__1 ^ 7 / 0.12e2) * sin(theta) * cos(theta) + (-(g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * p__1 ^ 7 * tan(theta) / 0.2e1 - ((v__1 ^ 2 - v__2 ^ 2 / 0.2e1) * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__2 ^ 5 + v__2 * p__1 ^ 6 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) / 0.2e1) * p__2) * sin(theta) ^ 2 + 0.5e1 / 0.6e1 * v__2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__2 ^ 7 + (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 * p__2 ^ 6 / 0.2e1 + 0.6e1 * v__2 * (0.7e1 / 0.36e2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__1 * p__2 ^ 5 + 0.7e1 / 0.2e1 * p__1 ^ 2 * ((((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 / 0.21e2 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.8e1 / 0.7e1 * v__2 ^ 2)) * p__2 ^ 4 - v__2 * p__1 ^ 4 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__2 ^ 3 / 0.6e1 + 0.4e1 * (-0.7e1 / 0.24e2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.7e1 / 0.8e1 * v__2 ^ 2)) * p__1 ^ 4 * p__2 ^ 2 - 0.6e1 * v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 5 * v__1 * p__2 - p__1 ^ 6 * (0.5e1 / 0.3e1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.2e1 * v__2 ^ 2)) / 0.2e1) * cos(phi) - (g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * (p__1 ^ 4 - p__1 ^ 2 * p__2 ^ 2 - p__2 ^ 4) * p__2 ^ 3 * cos(theta) + (-0.3e1 * v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1 * p__2 ^ 6 * sin(phi) ^ 2 + (g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * p__1 ^ 6 * p__2 * tan(theta) - (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__2 ^ 7 + 0.8e1 / 0.3e1 * v__2 * p__1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__2 ^ 6 - 0.5e1 * p__1 * ((((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 / 0.3e1 + (v__1 ^ 2 - 0.4e1 / 0.5e1 * v__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3)) * p__2 ^ 5 + 0.6e1 * v__2 * p__1 ^ 2 * (0.10e2 / 0.9e1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 4 - 0.4e1 * p__1 ^ 3 * ((((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 / 0.12e2 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - v__2 ^ 2 / 0.2e1)) * p__2 ^ 3 + 0.9e1 * (0.16e2 / 0.27e2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * v__2 * p__1 ^ 4 * p__2 ^ 2 + ((((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 / 0.3e1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.2e1 * v__2 ^ 2)) * p__1 ^ 5 * p__2 + 0.4e1 / 0.3e1 * v__2 * p__1 ^ 7 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3)) * sin(theta) - 0.5e1 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * (tan(theta) * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 3 * tan(phi) * p__2 ^ 4 * sin(phi) ^ 2 + ((g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 * (p__1 ^ 6 + 0.4e1 * p__1 ^ 4 * p__2 ^ 2 + 0.2e1 * p__2 ^ 6) * tan(theta) + 0.2e1 / 0.3e1 * Omega__2 ^ 2 * (p__1 ^ 2 + p__2 ^ 2) ^ 4) * tan(phi) / 0.5e1 - 0.2e1 / 0.15e2 * Omega__1 * Omega__2 * tan(theta) * (p__1 ^ 2 + p__2 ^ 2) ^ 4 * sec(phi) + 0.3e1 / 0.5e1 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * sec(theta) * (p__1 ^ 2 + 0.2e1 / 0.3e1 * p__2 ^ 2) * p__2 ^ 5)) * J__2 * sin(psi) - (Omega__1 * cos(theta) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * cos(phi) - 0.2e1 * Omega__1 * sec(phi) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * cos(theta) - 0.2e1 * (tan(phi) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * sin(theta) - 0.5e1 / 0.2e1 * v__1 * p__1 ^ 7 - 0.7e1 / 0.2e1 * v__1 * p__1 ^ 5 * p__2 ^ 2 + v__1 * p__1 ^ 3 * p__2 ^ 4 / 0.2e1 - 0.3e1 / 0.2e1 * v__2 * p__1 ^ 6 * p__2 - v__2 * p__1 ^ 4 * p__2 ^ 3 / 0.2e1 + 0.7e1 / 0.2e1 * v__2 * p__1 ^ 2 * p__2 ^ 5 + 0.5e1 / 0.2e1 * v__2 * p__2 ^ 7) * Omega__2) * (g + k__21 * (p__3 - r2) + k__22 * v__3) * J__2 * cos(psi) ^ 2 - 0.3e1 * J__2 * (((nu__1 * p__1 * p__2 ^ 6 / 0.6e1 + (-0.3e1 * v__2 * v__1 ^ 3 + 0.2e1 * v__2 ^ 3 * v__1) * p__2 ^ 5 + p__1 * (((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + nu__1 / 0.2e1 + g ^ 2 + 0.2e1 * v__3 * k__22 * g + v__3 ^ 2 * k__22 ^ 2) * p__1 ^ 2 - 0.3e1 * v__1 ^ 4 + 0.15e2 * v__1 ^ 2 * v__2 ^ 2 - 0.2e1 * v__2 ^ 4) * p__2 ^ 4 + 0.15e2 * (v__2 * v__1 ^ 3 - v__2 ^ 3 * v__1) * p__1 ^ 2 * p__2 ^ 3 + 0.2e1 * p__1 ^ 3 * (((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + v__3 ^ 2 * k__22 ^ 2 + 0.2e1 * v__3 * k__22 * g + g ^ 2 + nu__1 / 0.4e1) * p__1 ^ 2 + v__1 ^ 4 - 0.15e2 / 0.2e1 * v__1 ^ 2 * v__2 ^ 2 + 0.3e1 / 0.2e1 * v__2 ^ 4) * p__2 ^ 2 + (-0.2e1 * v__2 * v__1 ^ 3 + 0.3e1 * v__2 ^ 3 * v__1) * p__1 ^ 4 * p__2 + ((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + v__3 ^ 2 * k__22 ^ 2 + 0.2e1 * v__3 * k__22 * g + g ^ 2 + nu__1 / 0.6e1) * p__1 ^ 7) * cos(theta) ^ 2 + 0.4e1 * (((r2 - p__3) * k__21 ^ 2 + k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 + v__3 * k__22 ^ 3) * p__2 ^ 6 / 0.12e2 + v__2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__2 ^ 5 / 0.12e2 + (((r2 - p__3) * k__21 ^ 2 + k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 + v__3 * k__22 ^ 3) * p__1 ^ 2 / 0.2e1 - (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - v__2 ^ 2 / 0.2e1)) * p__2 ^ 4 / 0.2e1 + 0.9e1 / 0.4e1 * v__2 * p__1 * (0.2e1 / 0.27e2 * (((r2 - p__3) * k__22 + v__3) * k__21 - k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 3 + p__1 ^ 2 * (((r2 - p__3) * k__21 ^ 2 + k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 + v__3 * k__22 ^ 3) * p__1 ^ 2 / 0.4e1 - (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 / 0.3e1 + (v__1 ^ 2 - 0.5e1 / 0.4e1 * v__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3)) * p__2 ^ 2 - 0.3e1 / 0.4e1 * v__2 * p__1 ^ 3 * ((((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 / 0.3e1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 - (((p__3 - r2) * k__21 ^ 2 - k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * k__21 - v__3 * k__22 ^ 3) * p__1 / 0.4e1 + (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1) * p__1 ^ 5 / 0.3e1) * (p__1 ^ 2 + p__2 ^ 2) * sin(theta) * cos(theta) + 0.2e1 * (p__1 ^ 2 + 0.2e1 * p__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * p__1 ^ 3 * p__2 ^ 2) * cos(phi) + (-(((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__2 ^ 5 - 0.3e1 * v__2 * (0.8e1 / 0.9e1 * (((r2 - p__3) * k__22 + v__3) * k__21 - k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 4 - 0.5e1 * p__1 * (0.2e1 / 0.15e2 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (v__1 ^ 2 - 0.4e1 / 0.5e1 * v__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3)) * p__2 ^ 3 + 0.9e1 * v__2 * p__1 ^ 2 * (0.4e1 / 0.9e1 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 2 + ((((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 / 0.3e1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.2e1 * v__2 ^ 2)) * p__1 ^ 3 * p__2 + 0.4e1 / 0.3e1 * v__2 * p__1 ^ 5 * (((p__3 - r2) * k__22 - v__3) * k__21 + k__22 ^ 2 * v__3)) * sin(phi) * (p__1 ^ 2 + p__2 ^ 2) * cos(theta) - (g + k__21 * (p__3 - r2) + k__22 * v__3) * (-(g + k__21 * (p__3 - r2) + k__22 * v__3) * sin(phi) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (p__2 + p__1) * (p__1 - p__2) * p__2 * sin(theta) + 0.2e1 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 * tan(phi) * p__2 ^ 6 * sin(phi) - 0.2e1 / 0.3e1 * Omega__1 * Omega__2 * tan(phi) * (p__1 ^ 2 + p__2 ^ 2) ^ 4 + (-0.2e1 / 0.3e1 * Omega__2 ^ 2 * (p__1 ^ 2 + p__2 ^ 2) ^ 4 * tan(theta) + (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 3 * (p__1 ^ 4 + 0.4e1 * p__1 ^ 2 * p__2 ^ 2 + 0.5e1 * p__2 ^ 4)) * sec(phi))) * cos(psi) - (g + k__21 * (p__3 - r2) + k__22 * v__3) * sin(phi) * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * J__2 * Omega__1 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * tan(phi) * cos(theta) - (g + k__21 * (p__3 - r2) + k__22 * v__3) * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * J__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * tan(phi) * Omega__2 * sin(theta) + (((0.2e1 * Omega__2 * (p__3 - r2) * k__22 - 0.2e1 * v__3 * Omega__2 - Omega__3 * (p__3 - r2) * Omega__1) * k__21 + 0.2e1 * v__3 * k__22 ^ 2 * Omega__2 - Omega__3 * Omega__1 * v__3 * k__22 - Omega__3 * Omega__1 * g) * p__2 ^ 8 - 0.4e1 * v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * Omega__2 * p__2 ^ 7 - 0.4e1 * p__1 ^ 2 * ((-0.2e1 * Omega__2 * (p__3 - r2) * k__22 + 0.2e1 * v__3 * Omega__2 + Omega__3 * (p__3 - r2) * Omega__1) * k__21 - 0.2e1 * v__3 * k__22 ^ 2 * Omega__2 + Omega__3 * Omega__1 * v__3 * k__22 + Omega__3 * Omega__1 * g) * p__2 ^ 6 - 0.8e1 * v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 2 * Omega__2 * p__2 ^ 5 - 0.5e1 * p__1 ^ 3 * (0.6e1 / 0.5e1 * ((-0.2e1 * Omega__2 * (p__3 - r2) * k__22 + 0.2e1 * v__3 * Omega__2 + Omega__3 * (p__3 - r2) * Omega__1) * k__21 - 0.2e1 * v__3 * k__22 ^ 2 * Omega__2 + Omega__3 * Omega__1 * v__3 * k__22 + Omega__3 * Omega__1 * g) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1 * Omega__2) * p__2 ^ 4 - 0.4e1 * v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 4 * Omega__2 * p__2 ^ 3 - p__1 ^ 5 * (0.4e1 * ((-0.2e1 * Omega__2 * (p__3 - r2) * k__22 + 0.2e1 * v__3 * Omega__2 + Omega__3 * (p__3 - r2) * Omega__1) * k__21 - 0.2e1 * v__3 * k__22 ^ 2 * Omega__2 + Omega__3 * Omega__1 * v__3 * k__22 + Omega__3 * Omega__1 * g) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1 * Omega__2) * p__2 ^ 2 + p__1 ^ 7 * (((0.2e1 * Omega__2 * (p__3 - r2) * k__22 - 0.2e1 * v__3 * Omega__2 - Omega__3 * (p__3 - r2) * Omega__1) * k__21 + 0.2e1 * v__3 * k__22 ^ 2 * Omega__2 - Omega__3 * Omega__1 * v__3 * k__22 - Omega__3 * Omega__1 * g) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1 * Omega__2)) * J__2 + (J__1 - J__3) * Omega__3 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * Omega__1 * (p__1 ^ 2 + p__2 ^ 2) ^ 4) / (g + k__21 * (p__3 - r2) + k__22 * v__3) / (p__1 ^ 2 + p__2 ^ 2) ^ 4;
% tau__3 = (-0.6e1 * ((g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 * p__2 ^ 6 * sin(phi) + sin(theta) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (Omega__1 * sin(psi) + Omega__2 * cos(psi)) * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) / 0.6e1) * (g + k__21 * (p__3 - r2) + k__22 * v__3) * J__3 * tan(phi) ^ 2 - 0.3e1 * (((p__1 ^ 2 + p__2 ^ 2) ^ 2 * (cos(psi) * Omega__1 - sin(psi) * Omega__2) * (0.4e1 * v__2 * p__1 ^ 3 + v__1 * p__1 ^ 2 * p__2 + 0.8e1 * v__2 * p__1 * p__2 ^ 2 - 0.3e1 * v__1 * p__2 ^ 3) * cos(theta) / 0.3e1 - 0.2e1 / 0.3e1 * (p__1 ^ 2 + p__2 ^ 2) ^ 4 * (Omega__1 * sin(psi) + Omega__2 * cos(psi)) ^ 2 * tan(theta) + (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 3 * (p__1 ^ 4 + 0.4e1 * p__1 ^ 2 * p__2 ^ 2 + 0.5e1 * p__2 ^ 4)) * (g + k__21 * (p__3 - r2) + k__22 * v__3) * sec(phi) - (p__1 ^ 2 + p__2 ^ 2) * ((-((k__22 * p__3 - k__22 * r2 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__2 ^ 5 - 0.3e1 * v__2 * (0.8e1 / 0.9e1 * ((-k__22 * p__3 + k__22 * r2 + v__3) * k__21 - k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 4 - 0.5e1 * p__1 * (0.2e1 / 0.15e2 * ((k__22 * p__3 - k__22 * r2 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 + (v__1 ^ 2 - 0.4e1 / 0.5e1 * v__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3)) * p__2 ^ 3 + 0.9e1 * v__2 * p__1 ^ 2 * (0.4e1 / 0.9e1 * ((k__22 * p__3 - k__22 * r2 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 2 + p__1 ^ 3 * (((k__22 * p__3 - k__22 * r2 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 / 0.3e1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - 0.2e1 * v__2 ^ 2)) * p__2 + 0.4e1 / 0.3e1 * v__2 * p__1 ^ 5 * ((k__22 * p__3 - k__22 * r2 - v__3) * k__21 + k__22 ^ 2 * v__3)) * sin(phi) * cos(theta) + ((g + k__21 * (p__3 - r2) + k__22 * v__3) ^ 2 * (p__2 + p__1) * (p__1 - p__2) * p__2 * sin(phi) * sin(theta) + 0.4e1 / 0.3e1 * (Omega__1 * sin(psi) + Omega__2 * cos(psi)) * (((-k__22 * p__3 + k__22 * r2 + v__3) * k__21 - k__22 ^ 2 * v__3) * p__2 ^ 4 / 0.2e1 - v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__2 ^ 3 / 0.4e1 - p__1 ^ 2 * ((k__22 * p__3 - k__22 * r2 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__2 ^ 2 + 0.3e1 / 0.4e1 * v__2 * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 2 * p__2 + p__1 ^ 3 * (((-k__22 * p__3 + k__22 * r2 + v__3) * k__21 - k__22 ^ 2 * v__3) * p__1 / 0.2e1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1))) * (p__1 ^ 2 + p__2 ^ 2))) * J__3 * tan(phi) + J__3 * (nu__1 * p__1 * p__2 ^ 6 / 0.2e1 + 0.3e1 * (-0.3e1 * v__2 * v__1 ^ 3 + 0.2e1 * v__2 ^ 3 * v__1) * p__2 ^ 5 + 0.3e1 * p__1 * (((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + nu__1 / 0.2e1 + g ^ 2 + 0.2e1 * v__3 * k__22 * g + v__3 ^ 2 * k__22 ^ 2) * p__1 ^ 2 - 0.3e1 * v__1 ^ 4 + 0.15e2 * v__1 ^ 2 * v__2 ^ 2 - 0.2e1 * v__2 ^ 4) * p__2 ^ 4 + 0.45e2 * (v__2 * v__1 ^ 3 - v__2 ^ 3 * v__1) * p__1 ^ 2 * p__2 ^ 3 + 0.6e1 * p__1 ^ 3 * (((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + v__3 ^ 2 * k__22 ^ 2 + 0.2e1 * v__3 * k__22 * g + g ^ 2 + nu__1 / 0.4e1) * p__1 ^ 2 + v__1 ^ 4 - 0.15e2 / 0.2e1 * v__1 ^ 2 * v__2 ^ 2 + 0.3e1 / 0.2e1 * v__2 ^ 4) * p__2 ^ 2 + (0.3e1 * (-0.2e1 * v__2 * v__1 ^ 3 + 0.3e1 * v__2 ^ 3 * v__1) * p__1 ^ 4 + nu__3 * (p__1 ^ 2 + p__2 ^ 2) ^ (0.7e1 / 0.2e1)) * p__2 + 0.3e1 * ((p__3 - r2) ^ 2 * k__21 ^ 2 + 0.2e1 * (p__3 - r2) * (k__22 * v__3 + g) * k__21 + v__3 ^ 2 * k__22 ^ 2 + 0.2e1 * v__3 * k__22 * g + g ^ 2 + nu__1 / 0.6e1) * p__1 ^ 7) * sin(phi) * cos(theta) ^ 2 + 0.12e2 * sin(theta) * (p__1 ^ 2 + p__2 ^ 2) * J__3 * (((r2 - p__3) * k__21 ^ 2 + k__22 * (k__22 * p__3 - k__22 * r2 - 0.2e1 * v__3) * k__21 + v__3 * k__22 ^ 3) * p__2 ^ 6 / 0.12e2 + v__2 * ((k__22 * p__3 - k__22 * r2 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__2 ^ 5 / 0.12e2 + (((r2 - p__3) * k__21 ^ 2 + k__22 * (k__22 * p__3 - k__22 * r2 - 0.2e1 * v__3) * k__21 + v__3 * k__22 ^ 3) * p__1 ^ 2 / 0.2e1 - (g + k__21 * (p__3 - r2) + k__22 * v__3) * (v__1 ^ 2 - v__2 ^ 2 / 0.2e1)) * p__2 ^ 4 / 0.2e1 + 0.9e1 / 0.4e1 * v__2 * p__1 * (0.2e1 / 0.27e2 * ((-k__22 * p__3 + k__22 * r2 + v__3) * k__21 - k__22 ^ 2 * v__3) * p__1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 ^ 3 + p__1 ^ 2 * (((r2 - p__3) * k__21 ^ 2 + k__22 * (k__22 * p__3 - k__22 * r2 - 0.2e1 * v__3) * k__21 + v__3 * k__22 ^ 3) * p__1 ^ 2 / 0.4e1 - ((k__22 * p__3 - k__22 * r2 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1 * p__1 / 0.3e1 + (v__1 ^ 2 - 0.5e1 / 0.4e1 * v__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3)) * p__2 ^ 2 - 0.3e1 / 0.4e1 * v__2 * p__1 ^ 3 * (((k__22 * p__3 - k__22 * r2 - v__3) * k__21 + k__22 ^ 2 * v__3) * p__1 / 0.3e1 + (g + k__21 * (p__3 - r2) + k__22 * v__3) * v__1) * p__2 - p__1 ^ 5 * (((p__3 - r2) * k__21 ^ 2 - k__22 * (k__22 * p__3 - k__22 * r2 - 0.2e1 * v__3) * k__21 - v__3 * k__22 ^ 3) * p__1 / 0.4e1 + ((k__22 * p__3 - k__22 * r2 - v__3) * k__21 + k__22 ^ 2 * v__3) * v__1) / 0.3e1) * sin(phi) * cos(theta) + 0.6e1 * ((p__1 ^ 2 + 0.2e1 * p__2 ^ 2) * (g + k__21 * (p__3 - r2) + k__22 * v__3) * p__1 ^ 3 * J__3 * p__2 ^ 2 * sin(phi) + (p__1 ^ 2 + p__2 ^ 2) ^ 4 * (-0.2e1 * Omega__2 * cos(psi) ^ 2 * J__3 * Omega__1 + (-Omega__1 ^ 2 + Omega__2 ^ 2) * J__3 * sin(psi) * cos(psi) + (Omega__1 * Omega__2 + nu__4) * J__3 - Omega__1 * Omega__2 * (J__1 - J__2)) / 0.6e1) * (g + k__21 * (p__3 - r2) + k__22 * v__3)) / (g + k__21 * (p__3 - r2) + k__22 * v__3) / (p__1 ^ 2 + p__2 ^ 2) ^ 4;
% 
% tau = [tau__1;tau__2;tau__3];


%% tau: neat way
dh_1 = [2 * p__1 2 * p__2 0].';
dh_2 = [0 0 1].';

b1 = 0.2e1 * (-(k__22 * v__3 + g + k__21 * (p__3 - r2)) * (-p__2 * (0.2e1 * tan(phi) * J__1 * J__2 * (cos(psi) * Omega__2 + sin(psi) * Omega__1) ^ 2 * tan(theta) ^ 2 + (Omega__1 * Omega__2 * cos(psi) ^ 2 * tan(phi) * J__1 * J__2 + J__1 * (tan(phi) * J__2 * (Omega__1 - Omega__2) * (Omega__1 + Omega__2) * sin(psi) - Omega__1 * Omega__3 * (J__1 - J__2 - J__3)) * cos(psi) - sin(psi) * (sin(psi) * tan(phi) * J__1 * Omega__1 + Omega__3 * (J__1 - J__2 + J__3)) * Omega__2 * J__2) * sin(phi) * tan(theta) + Omega__3 * (-Omega__2 * J__2 * (J__1 - J__2 + J__3) * cos(psi) + Omega__1 * sin(psi) * J__1 * (J__1 - J__2 - J__3))) * sec(theta) + (0.2e1 * J__1 * J__2 * (cos(psi) * Omega__2 + sin(psi) * Omega__1) ^ 2 * tan(theta) + (Omega__1 * Omega__2 * cos(psi) ^ 2 * tan(phi) * J__1 * J__2 + J__1 * (tan(phi) * J__2 * (Omega__1 - Omega__2) * (Omega__1 + Omega__2) * sin(psi) - Omega__1 * Omega__3 * (J__1 - J__2 - J__3)) * cos(psi) - sin(psi) * (sin(psi) * tan(phi) * J__1 * Omega__1 + Omega__3 * (J__1 - J__2 + J__3)) * Omega__2 * J__2) * cos(phi)) * p__1 * (0.1e1 + tan(theta) ^ 2)) * sec(phi) ^ 2 - 0.2e1 * J__1 * ((-cos(theta) * (k__22 * v__3 + g + k__21 * (p__3 - r2)) * k__22 * p__1 * tan(theta) ^ 2 / 0.2e1 + (-0.3e1 / 0.2e1 * (k__22 * v__3 + g + k__21 * (p__3 - r2)) * p__2 * Omega__1 * (tan(phi) ^ 2 + 0.2e1 / 0.3e1) * cos(psi) + 0.3e1 / 0.2e1 * (k__22 * v__3 + g + k__21 * (p__3 - r2)) * p__2 * Omega__2 * (tan(phi) ^ 2 + 0.2e1 / 0.3e1) * sin(psi) + ((((p__3 - r2) * k__22 - v__3) * p__2 - 0.2e1 * v__2 * (p__3 - r2)) * k__21 + v__3 * k__22 ^ 2 * p__2 - 0.2e1 * v__2 * (k__22 * v__3 + g)) * tan(phi) + (k__22 * v__3 + g + k__21 * (p__3 - r2)) * (v__1 - k__22 * p__1 / 0.2e1) * sin(theta)) * tan(theta) - cos(theta) * (k__22 * v__3 + g + k__21 * (p__3 - r2)) * k__22 * p__1 / 0.2e1) * sec(theta) + ((k__22 * v__3 + g + k__21 * (p__3 - r2)) * tan(phi) * p__1 * Omega__1 * cos(psi) / 0.2e1 - (k__22 * v__3 + g + k__21 * (p__3 - r2)) * tan(phi) * Omega__2 * p__1 * sin(psi) / 0.2e1 + (p__1 * v__3 + v__1 * (p__3 - r2)) * k__21 + g * p__1 * k__22 + v__1 * (k__22 * v__3 + g)) * tan(theta) ^ 2 + (k__22 * v__3 + g + k__21 * (p__3 - r2)) * tan(phi) * p__1 * Omega__1 * cos(psi) / 0.2e1 - (k__22 * v__3 + g + k__21 * (p__3 - r2)) * tan(phi) * Omega__2 * p__1 * sin(psi) / 0.2e1 + (((-p__3 + r2) * k__22 / 0.2e1 + v__3) * p__1 + 0.2e1 * v__1 * (p__3 - r2)) * k__21 + k__22 * (-k__22 * v__3 + g) * p__1 / 0.2e1 + 0.2e1 * v__1 * (k__22 * v__3 + g)) * J__2 * (cos(psi) * Omega__2 + sin(psi) * Omega__1) * sec(phi) + 0.3e1 * J__1 * ((k__22 * v__3 + g + k__21 * (p__3 - r2)) ^ 2 * tan(phi) ^ 2 * sec(theta) ^ 2 + (0.2e1 * (k__22 * v__3 + g + k__21 * (p__3 - r2)) * tan(phi) * p__2 * (0.1e1 + tan(phi) ^ 2) * Omega__1 ^ 2 * cos(psi) ^ 2 + 0.4e1 * (0.1e1 + tan(phi) ^ 2) * (-(k__22 * v__3 + g + k__21 * (p__3 - r2)) * tan(phi) * p__2 * Omega__2 * sin(psi) + (((-p__3 + r2) * k__22 + v__3) * p__2 / 0.2e1 + v__2 * (p__3 - r2)) * k__21 - v__3 * k__22 ^ 2 * p__2 / 0.2e1 + v__2 * (k__22 * v__3 + g)) * Omega__1 * cos(psi) + 0.2e1 * (k__22 * v__3 + g + k__21 * (p__3 - r2)) * tan(phi) * p__2 * Omega__2 ^ 2 * (0.1e1 + tan(phi) ^ 2) * sin(psi) ^ 2 - 0.4e1 * ((((-p__3 + r2) * k__22 + v__3) * p__2 / 0.2e1 + v__2 * (p__3 - r2)) * k__21 - v__3 * k__22 ^ 2 * p__2 / 0.2e1 + v__2 * (k__22 * v__3 + g)) * Omega__2 * (0.1e1 + tan(phi) ^ 2) * sin(psi) + (-p__2 * (p__3 - r2) * k__21 ^ 2 + (k__22 * ((p__3 - r2) * k__22 - 0.2e1 * v__3) * p__2 - 0.4e1 * v__2 * ((p__3 - r2) * k__22 - v__3)) * k__21 - 0.4e1 * v__3 * k__22 ^ 2 * (-k__22 * p__2 / 0.4e1 + v__2)) * tan(phi) + (p__1 * (p__3 - r2) * k__21 ^ 2 + (((-p__3 + r2) * k__22 ^ 2 + 0.2e1 * k__22 * v__3 + g) * p__1 + 0.3e1 * ((p__3 - r2) * k__22 - 0.2e1 / 0.3e1 * v__3) * v__1) * k__21 + k__22 * (-v__3 * k__22 ^ 2 * p__1 + v__1 * (0.3e1 * k__22 * v__3 + g))) * sin(theta)) * sec(theta) / 0.3e1 + tan(theta) * ((k__22 * v__3 + g + k__21 * (p__3 - r2)) ^ 2 * tan(theta) + (-g * p__1 + ((p__3 - r2) * k__22 - 0.2e1 * v__3) * v__1) * k__21 / 0.3e1 - v__1 * k__22 * (-k__22 * v__3 + g) / 0.3e1)) * J__2) / J__1 / J__2;
b3 = (0.2e1 * (k__21 * p__3 - k__21 * r2 + k__22 * v__3 + g) * J__1 * (p__1 ^ 2 + p__2 ^ 2) ^ 3 * sec(theta) * ((p__1 * (sec(theta) ^ 2 - 0.2e1) * (Omega__1 - Omega__2) * (Omega__1 + Omega__2) * sec(phi) - 0.2e1 * Omega__1 * Omega__2 * sec(theta) * p__2) * tan(phi) - 0.4e1 * tan(theta) * (Omega__1 * sec(phi) ^ 2 * p__1 + Omega__2 * sec(phi) * sec(theta) * p__2 / 0.4e1 - Omega__1 * p__1 / 0.2e1) * Omega__2) * sec(phi) * J__2 * cos(psi) ^ 2 + (J__1 * (-0.2e1 * (k__21 * p__3 - k__21 * r2 + k__22 * v__3 + g) * (0.2e1 * (sec(theta) ^ 2 - 0.2e1) * Omega__1 * Omega__2 * p__1 * sec(phi) + (Omega__1 - Omega__2) * (Omega__1 + Omega__2) * sec(theta) * p__2) * (p__1 ^ 2 + p__2 ^ 2) * J__2 * sin(psi) + tan(theta) * (0.2e1 * v__3 * Omega__2 * J__2 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * k__22 ^ 2 + (((Omega__1 * Omega__3 * (J__1 - J__2 - J__3) * p__1 - 0.3e1 * v__1 * Omega__2 * J__2) * p__2 ^ 2 + 0.4e1 * v__2 * Omega__2 * J__2 * p__1 * p__2 + (Omega__1 * Omega__3 * (J__1 - J__2 - J__3) * p__1 + v__1 * Omega__2 * J__2) * p__1 ^ 2) * v__3 + 0.2e1 * k__21 * Omega__2 * J__2 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * (p__3 - r2)) * k__22 - 0.2e1 * k__21 * Omega__2 * J__2 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * v__3 + ((Omega__1 * Omega__3 * (J__1 - J__2 - J__3) * p__1 - 0.3e1 * v__1 * Omega__2 * J__2) * p__2 ^ 2 + 0.4e1 * v__2 * Omega__2 * J__2 * p__1 * p__2 + (Omega__1 * Omega__3 * (J__1 - J__2 - J__3) * p__1 + v__1 * Omega__2 * J__2) * p__1 ^ 2) * (k__21 * p__3 - k__21 * r2 + g))) * tan(phi) - 0.4e1 * (k__21 * p__3 - k__21 * r2 + k__22 * v__3 + g) * J__1 * (p__1 ^ 2 + p__2 ^ 2) * tan(theta) * (p__1 * (Omega__1 ^ 2 - Omega__2 ^ 2) * sec(phi) ^ 2 + Omega__1 * Omega__2 * sec(phi) * sec(theta) * p__2 + p__1 * (-Omega__1 ^ 2 / 0.2e1 + Omega__2 ^ 2 / 0.2e1)) * J__2 * sin(psi) + J__2 * (0.2e1 * v__3 * Omega__1 * J__1 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * k__22 ^ 2 + (((Omega__2 * Omega__3 * (J__1 - J__2 + J__3) * p__1 - 0.3e1 * v__1 * Omega__1 * J__1) * p__2 ^ 2 + 0.4e1 * v__2 * Omega__1 * J__1 * p__1 * p__2 + (Omega__2 * Omega__3 * (J__1 - J__2 + J__3) * p__1 + v__1 * Omega__1 * J__1) * p__1 ^ 2) * v__3 + 0.2e1 * k__21 * Omega__1 * J__1 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * (p__3 - r2)) * k__22 - 0.2e1 * k__21 * Omega__1 * J__1 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * v__3 + ((Omega__2 * Omega__3 * (J__1 - J__2 + J__3) * p__1 - 0.3e1 * v__1 * Omega__1 * J__1) * p__2 ^ 2 + 0.4e1 * v__2 * Omega__1 * J__1 * p__1 * p__2 + (Omega__2 * Omega__3 * (J__1 - J__2 + J__3) * p__1 + v__1 * Omega__1 * J__1) * p__1 ^ 2) * (k__21 * p__3 - k__21 * r2 + g)) * sec(phi) + 0.4e1 * J__1 * sec(theta) * (v__3 * Omega__2 * J__2 * p__2 * (p__1 ^ 2 + p__2 ^ 2) * k__22 ^ 2 / 0.2e1 + ((Omega__1 * Omega__3 * (J__1 - J__2 - J__3) * p__2 ^ 3 / 0.4e1 + v__2 * Omega__2 * J__2 * p__2 ^ 2 / 0.4e1 + (Omega__1 * Omega__3 * (J__1 - J__2 - J__3) * p__1 / 0.4e1 + v__1 * Omega__2 * J__2) * p__1 * p__2 - 0.3e1 / 0.4e1 * v__2 * Omega__2 * J__2 * p__1 ^ 2) * v__3 + k__21 * Omega__2 * J__2 * p__2 * (p__1 ^ 2 + p__2 ^ 2) * (p__3 - r2) / 0.2e1) * k__22 - k__21 * Omega__2 * J__2 * p__2 * (p__1 ^ 2 + p__2 ^ 2) * v__3 / 0.2e1 + (k__21 * p__3 - k__21 * r2 + g) * (Omega__1 * Omega__3 * (J__1 - J__2 - J__3) * p__2 ^ 3 / 0.4e1 + v__2 * Omega__2 * J__2 * p__2 ^ 2 / 0.4e1 + (Omega__1 * Omega__3 * (J__1 - J__2 - J__3) * p__1 / 0.4e1 + v__1 * Omega__2 * J__2) * p__1 * p__2 - 0.3e1 / 0.4e1 * v__2 * Omega__2 * J__2 * p__1 ^ 2))) * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * sec(theta) * sec(phi) * cos(psi) - 0.3e1 * (p__1 ^ 2 + p__2 ^ 2) * sec(theta) * (-(p__1 ^ 2 + p__2 ^ 2) * tan(theta) * sec(phi) * (0.2e1 * v__3 * Omega__1 * J__1 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * k__22 ^ 2 + (((Omega__2 * Omega__3 * (J__1 - J__2 + J__3) * p__1 - 0.3e1 * v__1 * Omega__1 * J__1) * p__2 ^ 2 + 0.4e1 * v__2 * Omega__1 * J__1 * p__1 * p__2 + (Omega__2 * Omega__3 * (J__1 - J__2 + J__3) * p__1 + v__1 * Omega__1 * J__1) * p__1 ^ 2) * v__3 + 0.2e1 * k__21 * Omega__1 * J__1 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * (p__3 - r2)) * k__22 - 0.2e1 * k__21 * Omega__1 * J__1 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * v__3 + ((Omega__2 * Omega__3 * (J__1 - J__2 + J__3) * p__1 - 0.3e1 * v__1 * Omega__1 * J__1) * p__2 ^ 2 + 0.4e1 * v__2 * Omega__1 * J__1 * p__1 * p__2 + (Omega__2 * Omega__3 * (J__1 - J__2 + J__3) * p__1 + v__1 * Omega__1 * J__1) * p__1 ^ 2) * (k__21 * p__3 - k__21 * r2 + g)) * sin(psi) / 0.3e1 + J__1 * (0.2e1 / 0.3e1 * Omega__1 ^ 2 * sec(phi) ^ 2 * p__1 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (k__21 * p__3 - k__21 * r2 + k__22 * v__3 + g) * tan(theta) ^ 2 + (p__1 - p__2) * (p__1 + p__2) * (p__1 ^ 2 + p__2 ^ 2) * (k__21 * p__3 - k__21 * r2 + k__22 * v__3 + g) ^ 2 * tan(theta) + 0.2e1 / 0.3e1 * Omega__2 ^ 2 * p__1 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (k__21 * p__3 - k__21 * r2 + k__22 * v__3 + g) * sec(phi) ^ 2 - 0.2e1 / 0.3e1 * Omega__1 * Omega__2 * sec(theta) * p__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (k__21 * p__3 - k__21 * r2 + k__22 * v__3 + g) * sec(phi) + v__3 * p__1 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * k__22 ^ 3 / 0.3e1 + (p__1 ^ 2 + p__2 ^ 2) * ((p__1 ^ 2 * v__1 + 0.4e1 * p__1 * p__2 * v__2 - 0.3e1 * p__2 ^ 2 * v__1) * v__3 + k__21 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * (p__3 - r2)) * k__22 ^ 2 / 0.3e1 + ((-0.2e1 / 0.3e1 * p__1 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * k__21 - 0.3e1 * v__1 * v__2 * p__2 ^ 3 + (-0.5e1 * v__1 ^ 2 + 0.4e1 * v__2 ^ 2) * p__1 * p__2 ^ 2 + 0.9e1 * v__1 * v__2 * p__1 ^ 2 * p__2 + p__1 ^ 3 * (v__1 ^ 2 - 0.2e1 * v__2 ^ 2)) * v__3 + k__21 * (p__1 ^ 2 + p__2 ^ 2) * (p__1 ^ 2 * v__1 + 0.4e1 * p__1 * p__2 * v__2 - 0.3e1 * p__2 ^ 2 * v__1) * (p__3 - r2) / 0.3e1) * k__22 - k__21 * (p__1 ^ 2 + p__2 ^ 2) * (p__1 ^ 2 * v__1 + 0.4e1 * p__1 * p__2 * v__2 - 0.3e1 * p__2 ^ 2 * v__1) * v__3 / 0.3e1 + (-p__1 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * k__21 / 0.3e1 - 0.3e1 * v__1 * v__2 * p__2 ^ 3 + (-0.5e1 * v__1 ^ 2 + 0.4e1 * v__2 ^ 2) * p__1 * p__2 ^ 2 + 0.9e1 * v__1 * v__2 * p__1 ^ 2 * p__2 + p__1 ^ 3 * (v__1 ^ 2 - 0.2e1 * v__2 ^ 2)) * k__21 * p__3 - (-p__1 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * k__21 / 0.3e1 - 0.3e1 * v__1 * v__2 * p__2 ^ 3 + (-0.5e1 * v__1 ^ 2 + 0.4e1 * v__2 ^ 2) * p__1 * p__2 ^ 2 + 0.9e1 * v__1 * v__2 * p__1 ^ 2 * p__2 + p__1 ^ 3 * (v__1 ^ 2 - 0.2e1 * v__2 ^ 2)) * k__21 * r2 + g * (-0.3e1 * v__1 * v__2 * p__2 ^ 3 + (-0.5e1 * v__1 ^ 2 + 0.4e1 * v__2 ^ 2) * p__1 * p__2 ^ 2 + 0.9e1 * v__1 * v__2 * p__1 ^ 2 * p__2 + p__1 ^ 3 * (v__1 ^ 2 - 0.2e1 * v__2 ^ 2)))) * J__2 * tan(phi) - 0.2e1 * Omega__1 ^ 2 * sec(phi) ^ 2 * sec(theta) ^ 2 * tan(theta) * J__1 * J__2 * p__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 3 * (k__21 * p__3 - k__21 * r2 + k__22 * v__3 + g) * sin(psi) ^ 2 + 0.4e1 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * sec(theta) * sec(phi) * (-J__1 * (0.2e1 * v__3 * Omega__2 * J__2 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * k__22 ^ 2 + (((Omega__1 * Omega__3 * (J__1 - J__2 - J__3) * p__1 - 0.3e1 * v__1 * Omega__2 * J__2) * p__2 ^ 2 + 0.4e1 * v__2 * Omega__2 * J__2 * p__1 * p__2 + (Omega__1 * Omega__3 * (J__1 - J__2 - J__3) * p__1 + v__1 * Omega__2 * J__2) * p__1 ^ 2) * v__3 + 0.2e1 * k__21 * Omega__2 * J__2 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * (p__3 - r2)) * k__22 - 0.2e1 * k__21 * Omega__2 * J__2 * p__1 * (p__1 ^ 2 + p__2 ^ 2) * v__3 + ((Omega__1 * Omega__3 * (J__1 - J__2 - J__3) * p__1 - 0.3e1 * v__1 * Omega__2 * J__2) * p__2 ^ 2 + 0.4e1 * v__2 * Omega__2 * J__2 * p__1 * p__2 + (Omega__1 * Omega__3 * (J__1 - J__2 - J__3) * p__1 + v__1 * Omega__2 * J__2) * p__1 ^ 2) * (k__21 * p__3 - k__21 * r2 + g)) * sec(phi) / 0.4e1 + sec(theta) * J__2 * (v__3 * Omega__1 * J__1 * p__2 * (p__1 ^ 2 + p__2 ^ 2) * k__22 ^ 2 / 0.2e1 + ((Omega__2 * Omega__3 * (J__1 - J__2 + J__3) * p__2 ^ 3 / 0.4e1 + v__2 * Omega__1 * J__1 * p__2 ^ 2 / 0.4e1 + (Omega__2 * Omega__3 * (J__1 - J__2 + J__3) * p__1 / 0.4e1 + v__1 * Omega__1 * J__1) * p__1 * p__2 - 0.3e1 / 0.4e1 * v__2 * Omega__1 * J__1 * p__1 ^ 2) * v__3 + k__21 * Omega__1 * J__1 * p__2 * (p__1 ^ 2 + p__2 ^ 2) * (p__3 - r2) / 0.2e1) * k__22 - k__21 * Omega__1 * J__1 * p__2 * (p__1 ^ 2 + p__2 ^ 2) * v__3 / 0.2e1 + (Omega__2 * Omega__3 * (J__1 - J__2 + J__3) * p__2 ^ 3 / 0.4e1 + v__2 * Omega__1 * J__1 * p__2 ^ 2 / 0.4e1 + (Omega__2 * Omega__3 * (J__1 - J__2 + J__3) * p__1 / 0.4e1 + v__1 * Omega__1 * J__1) * p__1 * p__2 - 0.3e1 / 0.4e1 * v__2 * Omega__1 * J__1 * p__1 ^ 2) * (k__21 * p__3 - k__21 * r2 + g))) * sin(psi) + 0.3e1 * J__1 * (-0.4e1 * (p__1 ^ 2 + p__2 ^ 2) * (-Omega__1 * Omega__2 * sec(theta) * p__1 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (k__21 * p__3 - k__21 * r2 + k__22 * v__3 + g) * sec(phi) ^ 3 / 0.3e1 + Omega__1 * Omega__2 * sec(theta) * p__1 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (k__21 * p__3 - k__21 * r2 + k__22 * v__3 + g) * sec(phi) / 0.6e1 + v__3 * p__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * k__22 ^ 3 / 0.12e2 + ((-0.3e1 * v__2 * p__1 ^ 2 + 0.4e1 * v__1 * p__1 * p__2 + v__2 * p__2 ^ 2) * v__3 + k__21 * p__2 * (p__1 ^ 2 + p__2 ^ 2) * (p__3 - r2)) * (p__1 ^ 2 + p__2 ^ 2) * k__22 ^ 2 / 0.12e2 + ((-p__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * k__21 / 0.6e1 + (-v__1 ^ 2 / 0.2e1 + v__2 ^ 2 / 0.4e1) * p__2 ^ 3 + 0.9e1 / 0.4e1 * p__2 ^ 2 * v__1 * p__1 * v__2 + p__1 ^ 2 * (v__1 ^ 2 - 0.5e1 / 0.4e1 * v__2 ^ 2) * p__2 - 0.3e1 / 0.4e1 * v__1 * p__1 ^ 3 * v__2) * v__3 + (p__3 - r2) * (p__1 ^ 2 + p__2 ^ 2) * (v__1 * p__1 * p__2 - 0.3e1 / 0.4e1 * v__2 * p__1 ^ 2 + v__2 * p__2 ^ 2 / 0.4e1) * k__21 / 0.3e1) * k__22 - (p__1 ^ 2 + p__2 ^ 2) * (v__1 * p__1 * p__2 - 0.3e1 / 0.4e1 * v__2 * p__1 ^ 2 + v__2 * p__2 ^ 2 / 0.4e1) * k__21 * v__3 / 0.3e1 + (-p__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * k__21 / 0.12e2 + (-v__1 ^ 2 / 0.2e1 + v__2 ^ 2 / 0.4e1) * p__2 ^ 3 + 0.9e1 / 0.4e1 * p__2 ^ 2 * v__1 * p__1 * v__2 + p__1 ^ 2 * (v__1 ^ 2 - 0.5e1 / 0.4e1 * v__2 ^ 2) * p__2 - 0.3e1 / 0.4e1 * v__1 * p__1 ^ 3 * v__2) * k__21 * p__3 - (-p__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * k__21 / 0.12e2 + (-v__1 ^ 2 / 0.2e1 + v__2 ^ 2 / 0.4e1) * p__2 ^ 3 + 0.9e1 / 0.4e1 * p__2 ^ 2 * v__1 * p__1 * v__2 + p__1 ^ 2 * (v__1 ^ 2 - 0.5e1 / 0.4e1 * v__2 ^ 2) * p__2 - 0.3e1 / 0.4e1 * v__1 * p__1 ^ 3 * v__2) * k__21 * r2 + g * ((-v__1 ^ 2 / 0.2e1 + v__2 ^ 2 / 0.4e1) * p__2 ^ 3 + 0.9e1 / 0.4e1 * p__2 ^ 2 * v__1 * p__1 * v__2 + p__1 ^ 2 * (v__1 ^ 2 - 0.5e1 / 0.4e1 * v__2 ^ 2) * p__2 - 0.3e1 / 0.4e1 * v__1 * p__1 ^ 3 * v__2)) * tan(theta) + sec(theta) ^ 2 * p__1 * p__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (k__21 * p__3 - k__21 * r2 + k__22 * v__3 + g) ^ 2 * sec(phi) ^ 2 - 0.2e1 * sec(theta) ^ 2 * p__1 * p__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (k__21 * p__3 - k__21 * r2 + k__22 * v__3 + g) ^ 2 + v__3 ^ 2 * p__1 * p__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * k__22 ^ 2 + 0.2e1 * v__3 * p__1 * p__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (k__21 * p__3 - k__21 * r2 + g) * k__22 + k__21 ^ 2 * p__1 * p__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * p__3 ^ 2 + 0.2e1 * k__21 * p__1 * p__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (-k__21 * r2 + g) * p__3 + k__21 ^ 2 * p__1 * p__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * r2 ^ 2 - 0.2e1 * g * k__21 * p__1 * p__2 * (p__1 ^ 2 + p__2 ^ 2) ^ 2 * r2 + g ^ 2 * p__1 * p__2 ^ 5 + (0.3e1 * v__1 ^ 3 * v__2 - 0.2e1 * v__1 * v__2 ^ 3) * p__2 ^ 4 + 0.2e1 * (g ^ 2 * p__1 ^ 2 + 0.3e1 / 0.2e1 * v__1 ^ 4 - 0.15e2 / 0.2e1 * v__2 ^ 2 * v__1 ^ 2 + v__2 ^ 4) * p__1 * p__2 ^ 3 + (-0.15e2 * v__1 ^ 3 * v__2 + 0.15e2 * v__1 * v__2 ^ 3) * p__2 ^ 2 * p__1 ^ 2 + p__1 ^ 3 * (g ^ 2 * p__1 ^ 2 - 0.2e1 * v__1 ^ 4 + 0.15e2 * v__2 ^ 2 * v__1 ^ 2 - 0.3e1 * v__2 ^ 4) * p__2 + (0.2e1 * v__1 ^ 3 * v__2 - 0.3e1 * v__1 * v__2 ^ 3) * p__1 ^ 4) * J__2) * (p__1 ^ 2 + p__2 ^ 2) ^ (-0.7e1 / 0.2e1) / J__1 / J__2;
b4 = 0.1e1 / J__1 / J__2 / J__3 * (-(2 * J__1 * J__2 * J__3 * p__1 * p__2 * v__1 ^ 2 / (p__1 ^ 2 + p__2 ^ 2) ^ 2) + (2 * J__1 * J__2 * J__3 * v__1 * v__2 / (p__1 ^ 2 + p__2 ^ 2) ^ 2 * (p__1 ^ 2 - p__2 ^ 2)) + (2 * J__1 * J__2 * J__3 * p__1 * p__2 * v__2 ^ 2 / (p__1 ^ 2 + p__2 ^ 2) ^ 2) + 0.2e1 * J__1 * J__2 * J__3 * (cos(psi) * Omega__2 + sin(psi) * Omega__1) * (cos(psi) * Omega__1 - sin(psi) * Omega__2) * tan(phi) ^ 2 + J__3 * Omega__3 * (J__1 * Omega__1 * (-J__1 + J__2 + J__3) * cos(psi) + J__2 * Omega__2 * (-J__1 + J__2 - J__3) * sin(psi)) * tan(phi) + J__2 * J__1 * (Omega__1 * Omega__2 * cos(psi) ^ 2 * J__3 + sin(psi) * J__3 * (Omega__1 - Omega__2) * (Omega__1 + Omega__2) * cos(psi) - Omega__1 * Omega__2 * sin(psi) ^ 2 * J__3 + J__1 * Omega__1 * Omega__2 - J__2 * Omega__1 * Omega__2));


rho = cross(dh_1,dh_2)/(norm(cross(dh_1,dh_2)));

Atilde11 = u__t * (   dot(  cross(dh_1,dh_2),R(:,1)  )   )/( m * J__1 * dot(dh_2,R(:,3) )  );
Atilde12 = u__t * (   dot(  cross(dh_1,dh_2),R(:,2)  )   )/( m * J__2 * dot(dh_2,R(:,3) )  );

Atilde21 = u__t * (   dot(  cross(dh_2,R(:,1)),rho  )   )/( m * J__1 * dot(dh_2,R(:,3) )  );
Atilde22 = u__t * (   dot(  cross(dh_2,R(:,2)),rho  )   )/( m * J__2 * dot(dh_2,R(:,3) )  );

Atilde31 = sin(psi)*tan(phi)/J__1;
Atilde32 = cos(psi)*tan(phi)/J__2;
Atilde33 = 1/J__3;

Atilde = [Atilde11, Atilde12, 0;...
          Atilde21, Atilde22, 0;...
          Atilde31, Atilde32, Atilde33];

-norm(cross(dh_1,dh_2))* u__t^2 /(m^2*J__1*J__2*J__3*dot(dh_2,R(:,3))) - det(Atilde);

tmp = dot(dh_2,R(:,3));
tau = Atilde\([nu__1;nu__3;nu__4] - [b1;b3;b4]);
tau__1 = tau(1);
tau__2 = tau(2);
tau__3 = tau(3);


%% Dynamics
dzdt(1:3,1) = v;
dzdt(4:6,1) = g*e3 - u__t*R*e3/m;
R_dot = R*SSS(OM);
R_dot = R_dot.';
dzdt(7:15,1) = R_dot(:);
% dzdt(7)  =  r12*om3 - r13*om2;      %r11 
% dzdt(8)  =  r13*om1 - r11*om3;      %r12
% dzdt(9)  =  r22*om3 - r23*om2;      %r21
% dzdt(10) =  r23*om1 - r21*om3;      %r22
% dzdt(11) =  r32*om3 - r33*om2;      %r31
% dzdt(12) =  r33*om1 - r31*om3;      %r32

dzdt(16:18,1) = J_inv*(tau - cross(OM,J*OM));
